{% extends "main/base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">


<a href="{% url 'home' %}" class="back-button">Back</a>

<div class="container">
    <div class="profile-header">
        <div class="profile-picture">
            <img src="{{ user.profile_pic.url }}" alt="Profile Picture" id="PicPreview" style="max-width: 150px;">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="file" name="profile_pic" id="pic" accept="image/*" style="display: none;" onchange="previewImage(event)">
                <button type="button" class="edit-button" onclick="document.getElementById('pic').click()">Edit Picture</button>
        </div>
        <h1>{{ user.username }}</h1>
    </div>

    <div class="personal-details">
        <div class="editdetailbtn">
            <h2>Personal Details</h2>
        </div>

        {% if messages %}
            {% for message in messages %}
                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}
            {{ form.non_field_errors }}
            <div class="form-group">
                {{ form.username.label_tag }}
                {{ form.username }}
                {{ form.username.errors }}
            </div>
            <div class="form-group">
                {{ form.contact.label_tag }}
                {{ form.contact }}
                {{ form.contact.errors }}
            </div>
            <div class="form-group">
                {{ form.email.label_tag }}
                {{ form.email }}
                {{ form.email.errors }}
            </div>
            <div class="form-group">
                {{ form.address.label_tag }}
                {{ form.address }}
                {{ form.address.errors }}
            </div>
            <div class="form-group">
                {{ form.password.label_tag }}
                {{ form.password }}
                {{ form.password.errors }}
            </div>
            <div class="form-group">
                {{ form.profile_pic.label_tag }}
                {{ form.profile_pic }}
                {{ form.profile_pic.errors }}
            </div>
            <h3 class="mt-3">Carrier Preferences</h3>
            <div class="form-group">
                {{ form.vehicle_type.label_tag }}
                {{ form.vehicle_type }}
                {{ form.vehicle_type.errors }}
            </div>
            <div class="form-group">
                {{ form.vehicle_capacity_kg.label_tag }}
                {{ form.vehicle_capacity_kg }}
                {{ form.vehicle_capacity_kg.errors }}
            </div>
            <div class="form-group">
                {{ form.base_rate_per_km.label_tag }}
                {{ form.base_rate_per_km }}
                {{ form.base_rate_per_km.errors }}
            </div>
            <div class="form-group">
                {{ form.current_latitude.label_tag }}
                {{ form.current_latitude }}
                {{ form.current_latitude.errors }}
            </div>
            <div class="form-group">
                {{ form.current_longitude.label_tag }}
                {{ form.current_longitude }}
                {{ form.current_longitude.errors }}
            </div>
            <div class="form-group">
                <button type="submit" class="save-changes">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<script src="{% static 'js/imgPreview.js' %}"></script>
<script>
function previewImage(event) {
    const output = document.getElementById('PicPreview');
    output.src = URL.createObjectURL(event.target.files[0]);
}
</script>

{% endblock %}
